async function mainFunc() {
  // Google search keywords: javascript await foreach
  // Reference link: https://stackoverflow.com/questions/51738684/await-with-array-foreach-containing-async-await
  await Promise.all(
    houseIdList.map((elm) => {
      createDom(elm);
    }),
  );
  //await houseIdList.map(createDom());
  // houseIdList.forEach((element) => {
  //   //alert(element);
  //   //getJson(element);
  //   //createDom(element);
  //  await createDom();
  // });
}
mainFunc();

// Google search keywords: get json with async
// Reference link: https://dmitripavlutin.com/javascript-fetch-async-await/
async function fetchData(url) {
  if (url != '') {
    const response = await fetch(url);
    const data = await response.json();
    //console.log(data);
    //const { name } = data;
    return data;
  }
}

// fetchCurrentLord().then((name) => {
//   name; // fetched name
// });

// function getJson(houseNum) {
//   // Google search keywords: JavaScript get json
//   // Reference link: https://stackoverflow.com/questions/12460378/how-to-get-json-from-url-in-javascript
//   const url = 'https://anapioficeandfire.com/api/houses/';
//   //https://www.anapioficeandfire.com/api/characters/238
//   fetch(url + houseNum)
//     .then((res) => res.json())
//     .then((out) => {
//       const { name, currentLord } = out;
//       //----------------------------------------------------------
//       // temp work
//       //----------------------------------------------------------
//       console.log(out);
//       //console.log('currentLord url! ', currentLord);
//       // document
//       //   .getElementById('got-house-list')
//       //   .append(
//       //     `<div class="got-house"><h1 class="got-house__title">${name}</h1><span class="got-house__current-lord">${currentLord}</span>`,
//       //   );
//       //-------------------------------------------------------------
//       // temp work
//       //-------------------------------------------------------------
//       createDom(name, currentLord);
//     })
//     .catch((err) => {
//       throw err;
//     });
// }

async function createDom(houseId) {
  // Google search keywords: javascript create dom
  // Reference link: https://www.javascripttutorial.net/dom/manipulating/create-a-dom-element/

  const houseDiv = document.createElement('div');
  houseDiv.classList.add('got-house');
  const houseTitleH1 = document.createElement('h1');
  houseTitleH1.classList.add('got-house__title');
  let currentLord = '';
  const houseNameStr = await fetchData(
    'https://anapioficeandfire.com/api/houses/' + houseId,
  ).then((data) => {
    //console.log('house', data);
    data; // fetched name
    houseTitleH1.innerHTML = data.name;
    currentLord = data.currentLord;
    //return ({ name } = data);
    //return data;
  });
  houseDiv.appendChild(houseTitleH1);
  const lordNameSpan = document.createElement('span');
  lordNameSpan.classList.add('got-house__current-lord');
  lordNameSpan.id = 'lordOf_' + houseId;
  const lordNameStr = await fetchData(currentLord).then((data) => {
    //console.log(data);
    data; // fetched name
    if (data !== undefined) {
      lordNameSpan.innerHTML = data.name;
    } else {
      lordNameSpan.innerHTML = 'With out Lord Name';
    }
    //return ({ name } = data);
    //return data;
  });
  //console.log(lordNameStr);
  //const lordNameStr = await getCurrentLord(currentLord.replace('www.', ''));

  houseDiv.appendChild(lordNameSpan);
  document.getElementById('got-house-list').appendChild(houseDiv);
}

// function getCurrentLord(lordUrl) {
//   if (lordUrl != '') {
//     //console.log(lordUrl);
//     fetch(lordUrl)
//       .then((res) => res.json())
//       .then((out) => {
//         const { name } = out;
//         console.log('Checkout this JSON! ', name);
//         return Promise.resolve(name);
//       })
//       .catch((err) => {
//         throw err;
//       });
//   } else {
//     return 'with out lord';
//   }
// }
document.getElementById('kill-random-lord-button').onclick = async () => {
  const rndHouseId =
    houseIdList[Math.floor(Math.random() * houseIdList.length)];
  let swornMembersArr = [];
  const houseNameStr = await fetchData(
    'https://anapioficeandfire.com/api/houses/' + rndHouseId,
  ).then((data) => {
    //console.log('house', data);
    data; // fetched name
    swornMembersArr = data.swornMembers;
    //return ({ name } = data);
    //return data;
  });
  const rndSwornMember =
    swornMembersArr[Math.floor(Math.random() * swornMembersArr.length)];
  console.log(rndSwornMember);
  const swornMemberStr = await fetchData(rndSwornMember).then((data) => {
    data; // fetched name
    console.log('swornMemberStr', data.name);
    document.getElementById('lordOf_' + rndHouseId).innerHTML = data.name;

    //return ({ name } = data);
    //return data;
  });
};
