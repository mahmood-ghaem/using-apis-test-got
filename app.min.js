houseIdList.forEach((element) => {
  //alert(element);
  getJson(element);
});

async function fetchCurrentLord(lordUrl) {
  if (lordUrl != '') {
    const response = await fetch(lordUrl);
    const data = await response.json();
    //console.log(data);
    //const { name } = data;
    return data.name;
  } else {
    return 'aaaaa';
  }
}

// fetchCurrentLord().then((name) => {
//   name; // fetched name
// });

function getJson(houseNum) {
  // Google search keywords: JavaScript get json
  // Reference link: https://stackoverflow.com/questions/12460378/how-to-get-json-from-url-in-javascript
  const url = 'https://anapioficeandfire.com/api/houses/';
  //https://www.anapioficeandfire.com/api/characters/238
  fetch(url + houseNum)
    .then((res) => res.json())
    .then((out) => {
      const { name, currentLord } = out;
      //----------------------------------------------------------
      // temp work
      //----------------------------------------------------------
      //console.log(typeof out);
      //console.log('currentLord url! ', currentLord);
      // document
      //   .getElementById('got-house-list')
      //   .append(
      //     `<div class="got-house"><h1 class="got-house__title">${name}</h1><span class="got-house__current-lord">${currentLord}</span>`,
      //   );
      //-------------------------------------------------------------
      // temp work
      //-------------------------------------------------------------
      createDom(name, currentLord);
    })
    .catch((err) => {
      throw err;
    });
}

async function createDom(name, currentLord) {
  // Google search keywords: javascript create dom
  // Reference link: https://www.javascripttutorial.net/dom/manipulating/create-a-dom-element/
  const houseDiv = document.createElement('div');
  houseDiv.classList.add('got-house');
  const houseTitleH1 = document.createElement('h1');
  houseTitleH1.classList.add('got-house__title');
  houseTitleH1.innerHTML = `${name}`;
  houseDiv.appendChild(houseTitleH1);
  const lordNameSpan = document.createElement('span');
  lordNameSpan.classList.add('got-house__current-lord');

  const lordNameStr = await fetchCurrentLord(currentLord).then((data) => {
    console.log(data);
    data; // fetched name
    lordNameSpan.innerHTML = data;
    //return ({ name } = data);
    //return data;
  });
  console.log(lordNameStr);
  //const lordNameStr = await getCurrentLord(currentLord.replace('www.', ''));

  houseDiv.appendChild(lordNameSpan);
  document.getElementById('got-house-list').appendChild(houseDiv);
}

function getCurrentLord(lordUrl) {
  if (lordUrl != '') {
    //console.log(lordUrl);
    fetch(lordUrl)
      .then((res) => res.json())
      .then((out) => {
        const { name } = out;
        console.log('Checkout this JSON! ', name);
        return Promise.resolve(name);
      })
      .catch((err) => {
        throw err;
      });
  } else {
    return 'with out lord';
  }
}
